<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Nat. Genet | 玉米多组学整合网络图谱</title>
    <link href="/2023/05/22/20230522-maizeMultiOmicsNetwork/"/>
    <url>/2023/05/22/20230522-maizeMultiOmicsNetwork/</url>
    
    <content type="html"><![CDATA[<p>随着技术发展，生命科学进入大数据时代。中心法则的提出和发展表明从DNA序列到表型之间存在多个层次的调控过程。利用多组学数据构建整合网络为解析复杂性状的遗传调控提新的有效途径，结合机器学习挖掘生物大数据更为解析表型变异的分子调控网络提供便利。“A multi-omics integrative network map of maize”这篇文献以玉米为例构建多组学网络，挖掘重要农艺性状基因和调控网络。</p><h2 id="构建多组学网络"><a href="#构建多组学网络" class="headerlink" title="构建多组学网络"></a>构建多组学网络</h2><p>作者收集了不同组织、时期的多个样本，使用多种方法分别构建了基因组网络、共表达网络、共翻译网络以及蛋白质互作网络。其中基因组网络由ChIA-PET方法构建，共表达网络由31个组织时期的转录组数据构建，共翻译网络由21个组织时期的Ribo-seq数据构建，蛋白质互作网络使用RLL-Y2H构建。最终构建了一个包含407,721个功能元件（node）、多于2,800,000个边（edge）的综合网络。</p><p><img src="/2023/05/22/20230522-maizeMultiOmicsNetwork/MultiOmicsNetwork.png" alt="玉米多组学整合网络图谱" title="玉米多组学整合网络图谱"></p><h2 id="重复基因功能分化"><a href="#重复基因功能分化" class="headerlink" title="重复基因功能分化"></a>重复基因功能分化</h2><p>基因复制（基因组加倍WGD、串联重复tandem duplication、近端重复proximal duplication、转座重复transposition duplication、散在重复dispersed duplication）为基因功能进化提供契机。相较于非旁系同源基因，玉米重复基因，尤其是串联重复、近端重复以及基因组加倍重复基因更倾向于富集在相同的模块中，且具有更小的SD（节点间最短距离），表明其功能的保守性。进而根据基因间相似性和差异性将其分为I ~ V5类，其相似性逐渐降低而差异性增加，分别代表保守的（I）、亚功能化（II）、新功能化（III和IV）以及无功能化/特化（V）。重复基因更倾向于富集在代表功能保守的类别中，表明其在网络中的功能相似性。从共表达到共转录再到互作组网络重复基因在I ~ V类中的比例各不相同且存在重新分组的现象。最后根据重复基因起源的时间和I ~ V类中的分布比例发现，新生成的基因倾向于更保守。</p><p><img src="/2023/05/22/20230522-maizeMultiOmicsNetwork/duplicatedGenes.png" alt="不同组学层间重复基因的网络相似性和差异性" title="不同组学层间重复基因的网络相似性和差异"></p><h2 id="玉米亚基因组间非对称调控"><a href="#玉米亚基因组间非对称调控" class="headerlink" title="玉米亚基因组间非对称调控"></a>玉米亚基因组间非对称调控</h2><p>玉米是一种异源四倍体物种，两套亚基因组中maize1保留了更多的基因，且maize1中的基因表达量比maize2基因表达量更高。通过比较两个亚基因组中同源基因的连接度（Degree）发现，从共表达到共翻译再到互作组网络，其连接度差异愈发明显，到互作组网络中存在显著差异。滑窗统计方法表明maize1中由更多的优势bins。</p><p><img src="/2023/05/22/20230522-maizeMultiOmicsNetwork/subgenome.png" alt="亚基因组间不对称的网络分化" title="亚基因组间不对称的网络分化"></p><h2 id="重要基因的功能网络"><a href="#重要基因的功能网络" class="headerlink" title="重要基因的功能网络"></a>重要基因的功能网络</h2><p>处于同一个网络中的基因可能具有相似的功能。因此作者搜集功能已知的基因并找到其所处的子网络，通过对子网络的分析鉴定了调控相同性状的新的功能基因。</p><p><img src="/2023/05/22/20230522-maizeMultiOmicsNetwork/functionalGenes.png" alt="多组学网络重建复杂性状的调控网络" title="多组学网络重建复杂性状的调控网络"></p><h2 id="花期新基因的预测"><a href="#花期新基因的预测" class="headerlink" title="花期新基因的预测"></a>花期新基因的预测</h2><p>花期是重要的农艺性状。作者搜集已知的玉米花期基因和其他物种花期基因的同源基因，结合多组学整合网络使用机器学习的方法建立预测模型，进而预测玉米花期基因。最终预测了2,651个花期相关基因，以及鉴定到8个子网络和花期相关，这8个子网络分别代表了不同的调控途径。对其中20个基因进行基因敲除并考察突变体和野生型的表型，作者验证了其在花期表型中的功能。</p><p><img src="/2023/05/22/20230522-maizeMultiOmicsNetwork/predictFTgenes.png" alt="使用多组学网路预测花期基因" title="使用多组学网路预测花期基因"></p><p><strong>原文链接</strong></p><p><a href="https://doi.org/10.1038/s41588-022-01262-1">Han L, Zhong W, Qian J, et al. A multi-omics integrative network map of maize. Nat Genet. 2023;55(1):144-153. doi:10.1038/s41588-022-01262-1</a></p>]]></content>
    
    
    <categories>
      
      <category>文献解读</category>
      
    </categories>
    
    
    <tags>
      
      <tag>玉米</tag>
      
      <tag>多组学</tag>
      
      <tag>网络</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>搞对象一周年纪念日</title>
    <link href="/2023/04/24/20230424-FirstYearAnniversary/"/>
    <url>/2023/04/24/20230424-FirstYearAnniversary/</url>
    
    <content type="html"><![CDATA[<p>快乐的时光总是飞快的，我们在一起一年了</p><p><img src="/2023/04/24/20230424-FirstYearAnniversary/cake.jpg" alt="一周年蛋糕" title="一周年蛋糕"></p>]]></content>
    
    
    <categories>
      
      <category>记录生活</category>
      
    </categories>
    
    
    <tags>
      
      <tag>开心</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>QTL-seq系列 | 如何计算置信区间</title>
    <link href="/2023/04/22/20230422-getQTLseqCI/"/>
    <url>/2023/04/22/20230422-getQTLseqCI/</url>
    
    <content type="html"><![CDATA[<p><a href="http://laowang2023.cn/2023/04/22/20230422-QTLseqMethod/">书接上文</a>，在计算出ΔSNP-index之后如何判断该位点是否存在QTL？这里通过随机模拟实验来确定ΔSNP-index的置信区间（H0: 没有QTL）。</p><p><img src="/2023/04/22/20230422-getQTLseqCI/method.png" alt="计算原理" title="计算原理"></p><h2 id="计算原理"><a href="#计算原理" class="headerlink" title="计算原理"></a>计算原理</h2><h3 id="模拟取样过程"><a href="#模拟取样过程" class="headerlink" title="模拟取样过程"></a>模拟取样过程</h3><p>双亲杂交（AA × BB）、自交后产生包含大量子代个体的分离群体（RIL或F<sub>2</sub>），随机抽取两组若干个体构成两个模拟bulk pool。对于构成bulk pool的每一个个体可能的基因型以及概率是固定的，RIL群体为AA:BB=0.5:0.5，而F<sub>2</sub>群体为AA:AB:BB=0.25:0.5:0.25，由此可以计算出给定子代数目的bulk pool中的等位基因频率P(A)和P(B)。</p><h3 id="模拟计算ΔSNP-index"><a href="#模拟计算ΔSNP-index" class="headerlink" title="模拟计算ΔSNP-index"></a>模拟计算ΔSNP-index</h3><p>前面计算出了bulk pool中的等位基因频率，那么在特定测序深度（N）下等位基因A出现的次数就相当于进行N次二项分布取样$n(A) = X \sim B(N,P(A))$，进而可以得到SNP index = n(A)/N，两个bulk pool的SNP index相减得到ΔSNP-index。</p><h3 id="计算零假设下的ΔSNP-index分布"><a href="#计算零假设下的ΔSNP-index分布" class="headerlink" title="计算零假设下的ΔSNP-index分布"></a>计算零假设下的ΔSNP-index分布</h3><p>将以上过程重复若干次（10000次）可以得到在零假设下的ΔSNP-index的分布，取其上分位数和下分位数可以得到对应置信区间（如95%置信区间取上0.025分位数和下0.025分位数）。</p><h2 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2><p>这里使用R语言实现上述过程。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># 加载R包</span><br>library<span class="hljs-punctuation">(</span>tidyverse<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>cowplot<span class="hljs-punctuation">)</span><br><span class="hljs-comment"># 定义基本信息</span><br>popType <span class="hljs-operator">&lt;-</span> <span class="hljs-string">&quot;RIL&quot;</span>    <span class="hljs-comment"># 群体类型，RIL或F2</span><br>bulkSizeH <span class="hljs-operator">&lt;-</span> 30     <span class="hljs-comment"># 高值表型bulk pool个体数</span><br>bulkSizeL <span class="hljs-operator">&lt;-</span> 30     <span class="hljs-comment"># 低值表型bulk pool个体数</span><br>minDepth <span class="hljs-operator">&lt;-</span> 5       <span class="hljs-comment"># 最低覆盖深度</span><br>maxDepth <span class="hljs-operator">&lt;-</span> 150     <span class="hljs-comment"># 最高覆盖深度</span><br>repN <span class="hljs-operator">&lt;-</span> 10000       <span class="hljs-comment"># 模拟实验重复次数</span><br><span class="hljs-comment"># 定义数据框，每一行代表两个bulk pool的不同覆盖深度</span><br>dltIndex_CI <span class="hljs-operator">&lt;-</span> tibble<span class="hljs-punctuation">(</span>HB.DP <span class="hljs-operator">=</span> <span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span>minDepth<span class="hljs-operator">:</span>maxDepth<span class="hljs-punctuation">,</span> times <span class="hljs-operator">=</span> maxDepth<span class="hljs-operator">-</span>minDepth<span class="hljs-operator">+</span><span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <br>                      LB.DP <span class="hljs-operator">=</span> <span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span>minDepth<span class="hljs-operator">:</span>maxDepth<span class="hljs-punctuation">,</span> each <span class="hljs-operator">=</span> maxDepth<span class="hljs-operator">-</span>minDepth<span class="hljs-operator">+</span><span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                      CI95upper <span class="hljs-operator">=</span> <span class="hljs-literal">NA</span><span class="hljs-punctuation">,</span> CI95lower <span class="hljs-operator">=</span> <span class="hljs-literal">NA</span><span class="hljs-punctuation">,</span> CI99upper <span class="hljs-operator">=</span> <span class="hljs-literal">NA</span><span class="hljs-punctuation">,</span> CI99lower <span class="hljs-operator">=</span> <span class="hljs-literal">NA</span><span class="hljs-punctuation">)</span><br><span class="hljs-comment"># 定义一个进度条，用于显示计算进度</span><br>width <span class="hljs-operator">&lt;-</span> options<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-operator">$</span>width<br>pb <span class="hljs-operator">&lt;-</span> progress<span class="hljs-operator">::</span>progress_bar<span class="hljs-operator">$</span>new<span class="hljs-punctuation">(</span><br>  format <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;Progress [:bar] :percent eta: :eta&#x27;</span><span class="hljs-punctuation">,</span><br>  total <span class="hljs-operator">=</span> nrow<span class="hljs-punctuation">(</span>dltIndex_CI<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> clear <span class="hljs-operator">=</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">,</span> width <span class="hljs-operator">=</span> width<br><span class="hljs-punctuation">)</span><br><span class="hljs-comment"># 对不同覆盖深度循环计算置信区间，即循环dltIndex_CI的每一行</span><br><span class="hljs-keyword">for</span> <span class="hljs-punctuation">(</span>i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span><span class="hljs-operator">:</span>nrow<span class="hljs-punctuation">(</span>dltIndex_CI<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>  depthH <span class="hljs-operator">&lt;-</span> dltIndex_CI<span class="hljs-punctuation">[</span>i<span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">[[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><br>  depthL <span class="hljs-operator">&lt;-</span> dltIndex_CI<span class="hljs-punctuation">[</span>i<span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">[[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><br>  <span class="hljs-comment"># 模拟计算high bulk pool和low bulk pool的等位基因频率，重复repN次</span><br>  <span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span>popType <span class="hljs-operator">==</span> <span class="hljs-string">&quot;RIL&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>    PH <span class="hljs-operator">&lt;-</span> rbinom<span class="hljs-punctuation">(</span>repN<span class="hljs-punctuation">,</span> bulkSizeH<span class="hljs-punctuation">,</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">/</span> bulkSizeH<br>    PL <span class="hljs-operator">&lt;-</span> rbinom<span class="hljs-punctuation">(</span>repN<span class="hljs-punctuation">,</span> bulkSizeL<span class="hljs-punctuation">,</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">/</span> bulkSizeL<br>  <span class="hljs-punctuation">&#125;</span> <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span>popType <span class="hljs-operator">==</span> <span class="hljs-string">&quot;F2&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>    PH <span class="hljs-operator">&lt;-</span> apply<span class="hljs-punctuation">(</span>rmultinom<span class="hljs-punctuation">(</span>repN<span class="hljs-punctuation">,</span> bulkSizeH<span class="hljs-punctuation">,</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">*</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">/</span> bulkSizeH<span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">sum</span><span class="hljs-punctuation">)</span><br>    PL <span class="hljs-operator">&lt;-</span> apply<span class="hljs-punctuation">(</span>rmultinom<span class="hljs-punctuation">(</span>repN<span class="hljs-punctuation">,</span> bulkSizeL<span class="hljs-punctuation">,</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">*</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">/</span> bulkSizeL<span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">sum</span><span class="hljs-punctuation">)</span><br>  <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-comment"># 模拟计算两个bulk pool的ΔSNP-index，重复repN次</span><br>  indexH <span class="hljs-operator">&lt;-</span> rbinom<span class="hljs-punctuation">(</span>repN<span class="hljs-punctuation">,</span> depthH<span class="hljs-punctuation">,</span> PH<span class="hljs-punctuation">)</span> <span class="hljs-operator">/</span> depthH<br>  indexL <span class="hljs-operator">&lt;-</span> rbinom<span class="hljs-punctuation">(</span>repN<span class="hljs-punctuation">,</span> depthL<span class="hljs-punctuation">,</span> PL<span class="hljs-punctuation">)</span> <span class="hljs-operator">/</span> depthL<br>  dltIndex <span class="hljs-operator">&lt;-</span> indexH <span class="hljs-operator">-</span> indexL<br>  <span class="hljs-comment"># 取上分位数和下分位数作为置信区间</span><br>  dltIndex_CI<span class="hljs-punctuation">[</span>i<span class="hljs-punctuation">,</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;CI95upper&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;CI95lower&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;CI99upper&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;CI99lower&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> t<span class="hljs-punctuation">(</span><br>    <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span>quantile<span class="hljs-punctuation">(</span>dltIndex<span class="hljs-punctuation">,</span> <span class="hljs-number">0.975</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> quantile<span class="hljs-punctuation">(</span>dltIndex<span class="hljs-punctuation">,</span> <span class="hljs-number">0.025</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <br>      quantile<span class="hljs-punctuation">(</span>dltIndex<span class="hljs-punctuation">,</span> <span class="hljs-number">0.995</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> quantile<span class="hljs-punctuation">(</span>dltIndex<span class="hljs-punctuation">,</span> <span class="hljs-number">0.005</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>  <span class="hljs-punctuation">)</span><br>  <span class="hljs-comment"># 打印进度条</span><br>  pb<span class="hljs-operator">$</span>tick<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">&#125;</span><br><span class="hljs-comment"># 保存结果，导出指定群体类型、bulk pool大小下不同覆盖深度的置信区间</span><br>save<span class="hljs-punctuation">(</span>dltIndex_CI<span class="hljs-punctuation">,</span> <br>     file <span class="hljs-operator">=</span> paste<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;QTLseqCI&quot;</span><span class="hljs-punctuation">,</span> <br>                  paste<span class="hljs-punctuation">(</span>paste<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;indH&quot;</span><span class="hljs-punctuation">,</span> bulkSizeH<span class="hljs-punctuation">,</span> sep <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <br>                        paste<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;indL&quot;</span><span class="hljs-punctuation">,</span> bulkSizeL<span class="hljs-punctuation">,</span> sep <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <br>                        popType<span class="hljs-punctuation">,</span> sep <span class="hljs-operator">=</span> <span class="hljs-string">&quot;_&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <br>                  paste<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Depth&quot;</span><span class="hljs-punctuation">,</span> minDepth<span class="hljs-punctuation">,</span> maxDepth<span class="hljs-punctuation">,</span> sep <span class="hljs-operator">=</span> <span class="hljs-string">&quot;_&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <br>                  paste<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Rep&quot;</span><span class="hljs-punctuation">,</span> repN<span class="hljs-punctuation">,</span> sep <span class="hljs-operator">=</span> <span class="hljs-string">&quot;_&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-string">&quot;RData&quot;</span><span class="hljs-punctuation">,</span> sep <span class="hljs-operator">=</span> <span class="hljs-string">&quot;.&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><span class="hljs-comment"># 将置信区间和覆盖深度的关系可视化</span><br>df <span class="hljs-operator">&lt;-</span> gather<span class="hljs-punctuation">(</span>dltIndex_CI<span class="hljs-punctuation">,</span> type<span class="hljs-punctuation">,</span> CI<span class="hljs-punctuation">,</span> <span class="hljs-operator">-</span>HB.DP<span class="hljs-punctuation">,</span> <span class="hljs-operator">-</span>LB.DP<span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span> <br>  mutate<span class="hljs-punctuation">(</span>level <span class="hljs-operator">=</span> if_else<span class="hljs-punctuation">(</span>str_detect<span class="hljs-punctuation">(</span>type<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;95&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;95 CI&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;99 CI&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>         direction <span class="hljs-operator">=</span> if_else<span class="hljs-punctuation">(</span>str_detect<span class="hljs-punctuation">(</span>type<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;upper&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;Upper CI&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;Lower CI&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>df<span class="hljs-operator">$</span>direction <span class="hljs-operator">&lt;-</span> factor<span class="hljs-punctuation">(</span>df<span class="hljs-operator">$</span>direction<span class="hljs-punctuation">,</span> levels <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Upper CI&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;Lower CI&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>P_CI <span class="hljs-operator">&lt;-</span> ggplot<span class="hljs-punctuation">(</span>df<span class="hljs-punctuation">,</span> aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> HB.DP<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> LB.DP<span class="hljs-punctuation">,</span> fill <span class="hljs-operator">=</span> CI<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <br>  geom_tile<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <br>  scale_x_continuous<span class="hljs-punctuation">(</span>expand <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  scale_y_continuous<span class="hljs-punctuation">(</span>expand <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  scale_fill_distiller<span class="hljs-punctuation">(</span>palette <span class="hljs-operator">=</span> <span class="hljs-string">&quot;RdBu&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  labs<span class="hljs-punctuation">(</span>title <span class="hljs-operator">=</span> paste<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;CI&quot;</span><span class="hljs-punctuation">,</span> <br>                     paste<span class="hljs-punctuation">(</span>paste<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;indH&quot;</span><span class="hljs-punctuation">,</span> bulkSizeH<span class="hljs-punctuation">,</span> sep <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <br>                           paste<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;indL&quot;</span><span class="hljs-punctuation">,</span> bulkSizeL<span class="hljs-punctuation">,</span> sep <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <br>                           popType<span class="hljs-punctuation">,</span> sep <span class="hljs-operator">=</span> <span class="hljs-string">&quot;_&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <br>                     paste<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Depth&quot;</span><span class="hljs-punctuation">,</span> minDepth<span class="hljs-punctuation">,</span> maxDepth<span class="hljs-punctuation">,</span> sep <span class="hljs-operator">=</span> <span class="hljs-string">&quot;_&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <br>                     paste<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Rep&quot;</span><span class="hljs-punctuation">,</span> repN<span class="hljs-punctuation">,</span> sep <span class="hljs-operator">=</span> <span class="hljs-string">&quot;_&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> sep <span class="hljs-operator">=</span> <span class="hljs-string">&quot;.&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>       fill <span class="hljs-operator">=</span> <span class="hljs-literal">NULL</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  facet_grid<span class="hljs-punctuation">(</span>direction <span class="hljs-operator">~</span> level<span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  theme_half_open<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  theme<span class="hljs-punctuation">(</span>strip.background <span class="hljs-operator">=</span> element_rect<span class="hljs-punctuation">(</span>fill <span class="hljs-operator">=</span> <span class="hljs-string">&quot;#90EE90&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>        plot.title <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>hjust <span class="hljs-operator">=</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>ggsave<span class="hljs-punctuation">(</span>P_CI<span class="hljs-punctuation">,</span> filename <span class="hljs-operator">=</span> paste<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;QTLseqCI&quot;</span><span class="hljs-punctuation">,</span> <br>                              paste<span class="hljs-punctuation">(</span>paste<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;indH&quot;</span><span class="hljs-punctuation">,</span> bulkSizeH<span class="hljs-punctuation">,</span> sep <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <br>                                    paste<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;indL&quot;</span><span class="hljs-punctuation">,</span> bulkSizeL<span class="hljs-punctuation">,</span> sep <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <br>                                    popType<span class="hljs-punctuation">,</span> sep <span class="hljs-operator">=</span> <span class="hljs-string">&quot;_&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <br>                              paste<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Depth&quot;</span><span class="hljs-punctuation">,</span> minDepth<span class="hljs-punctuation">,</span> maxDepth<span class="hljs-punctuation">,</span> sep <span class="hljs-operator">=</span> <span class="hljs-string">&quot;_&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <br>                              paste<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Rep&quot;</span><span class="hljs-punctuation">,</span> repN<span class="hljs-punctuation">,</span> sep <span class="hljs-operator">=</span> <span class="hljs-string">&quot;_&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                              <span class="hljs-string">&quot;pdf&quot;</span><span class="hljs-punctuation">,</span> sep <span class="hljs-operator">=</span> <span class="hljs-string">&quot;.&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>       width <span class="hljs-operator">=</span> <span class="hljs-number">6.5</span><span class="hljs-punctuation">,</span> height <span class="hljs-operator">=</span> <span class="hljs-number">6</span><span class="hljs-punctuation">)</span><br>ggsave<span class="hljs-punctuation">(</span>P_CI<span class="hljs-punctuation">,</span> filename <span class="hljs-operator">=</span> paste<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;QTLseqCI&quot;</span><span class="hljs-punctuation">,</span> <br>                              paste<span class="hljs-punctuation">(</span>paste<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;indH&quot;</span><span class="hljs-punctuation">,</span> bulkSizeH<span class="hljs-punctuation">,</span> sep <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <br>                                    paste<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;indL&quot;</span><span class="hljs-punctuation">,</span> bulkSizeL<span class="hljs-punctuation">,</span> sep <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <br>                                    popType<span class="hljs-punctuation">,</span> sep <span class="hljs-operator">=</span> <span class="hljs-string">&quot;_&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <br>                              paste<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Depth&quot;</span><span class="hljs-punctuation">,</span> minDepth<span class="hljs-punctuation">,</span> maxDepth<span class="hljs-punctuation">,</span> sep <span class="hljs-operator">=</span> <span class="hljs-string">&quot;_&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <br>                              paste<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Rep&quot;</span><span class="hljs-punctuation">,</span> repN<span class="hljs-punctuation">,</span> sep <span class="hljs-operator">=</span> <span class="hljs-string">&quot;_&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                              <span class="hljs-string">&quot;png&quot;</span><span class="hljs-punctuation">,</span> sep <span class="hljs-operator">=</span> <span class="hljs-string">&quot;.&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>       width <span class="hljs-operator">=</span> <span class="hljs-number">6.5</span><span class="hljs-punctuation">,</span> height <span class="hljs-operator">=</span> <span class="hljs-number">6</span><span class="hljs-punctuation">,</span> units <span class="hljs-operator">=</span> <span class="hljs-string">&quot;in&quot;</span><span class="hljs-punctuation">,</span> dpi <span class="hljs-operator">=</span> <span class="hljs-number">500</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><p><img src="/2023/04/22/20230422-getQTLseqCI/QTLseqCI.png" alt="置信区间和覆盖深度的关系" title="置信区间和覆盖深度的关系"></p><p><strong>参考文献</strong></p><p><a href="https://onlinelibrary.wiley.com/doi/10.1111/tpj.12105">Takagi H, Abe A, Yoshida K, et al. QTL-seq: rapid mapping of quantitative trait loci in rice by whole genome resequencing of DNA from two bulked populations. Plant J. 2013;74(1):174-183. doi:10.1111/tpj.12105</a></p>]]></content>
    
    
    <categories>
      
      <category>技术分享</category>
      
    </categories>
    
    
    <tags>
      
      <tag>R</tag>
      
      <tag>QTL-seq</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>QTL-seq系列 | QTL-seq原理</title>
    <link href="/2023/04/22/20230422-QTLseqMethod/"/>
    <url>/2023/04/22/20230422-QTLseqMethod/</url>
    
    <content type="html"><![CDATA[<p>QTL-seq是一种将Bulked‐segregant analysis (BSA)和高通量测序相结合，快速定位质量性状或数量性状主效QTL的方法。</p><p>BSA方法最早使用RLFP或其他分子标记，分别在番茄中鉴定到果实脱落和成熟相关的基因组片段和标记，在生菜中鉴定到和抗霜霉病基因连锁的分子标记。</p><p><img src="/2023/04/22/20230422-QTLseqMethod/BSASchematicDiagram1.png" alt="BSA原理1" title="BSA原理1"></p><p><img src="/2023/04/22/20230422-QTLseqMethod/BSASchematicDiagram2.png" alt="BSA原理2" title="BSA原理2"></p><p>选取目标性状有差异的双亲构建的分离群体（RIL或F<sub>2</sub>），在分离群体中选取极端表型个体提取DNA并等量混合构建两个极端表型bulk pool，对混合DNA进行高通量测序（NGS）。同时应对至少其中一个亲本进行测序或其中一个亲本有参考基因组序列。随后进行变异分析，筛选出双亲间具有多态性的SNP位点（AA × BB）。分别计算两个bulk pool中每个SNP位点上某一亲本基因型read覆盖深度占该位点总read深度的比值，即SNP-index，两个bulk pool的SNP-index相减得到ΔSNP-index，为了减少测序和变异分析中出现的假阳性SNP位点的影响，采用滑窗统计的方法对ΔSNP-index进行平滑处理。将ΔSNP-index按照基因组位置画图，在基因组所有区域中，目标基因及其连锁的区域由于根据表型受到相反的选择在两个bulk pool中表现出不同的趋势，因此ΔSNP index会显著偏离0附近；另一方面，于目标形状无关的区域则两个bulk pool则表现为相似的变化趋势，因此ΔSNP index会在0附近波动。</p><p><img src="/2023/04/22/20230422-QTLseqMethod/QTLseqSchematicDiagram.png" alt="QTL-seq原理" title="QTL-seq原理"></p><p><strong>参考文献</strong></p><ol><li><a href="https://doi.org/10.1073/pnas.88.21.9828">Michelmore RW, Paran I, Kesseli RV. Identification of markers linked to disease-resistance genes by bulked segregant analysis: a rapid method to detect markers in specific genomic regions by using segregating populations. Proc Natl Acad Sci U S A. 1991;88(21):9828-9832. doi:10.1073/pnas.88.21.9828</a></li><li><a href="https://doi:10.1093/nar/19.23.6553">Giovannoni JJ, Wing RA, Ganal MW, Tanksley SD. Isolation of molecular markers from specific chromosomal intervals using DNA pools from existing mapping populations. Nucleic Acids Res. 1991;19(23):6553-6558. doi:10.1093/nar/19.23.6553</a></li><li><a href="https://doi:10.1111/tpj.12105">Takagi H, Abe A, Yoshida K, et al. QTL-seq: rapid mapping of quantitative trait loci in rice by whole genome resequencing of DNA from two bulked populations. Plant J. 2013;74(1):174-183. doi:10.1111/tpj.12105</a></li></ol><p><strong>完整代码</strong></p><p><a href="https://github.com/laowang1992/QTLseq_workflow">我的GitHub</a></p>]]></content>
    
    
    <categories>
      
      <category>技术分享</category>
      
    </categories>
    
    
    <tags>
      
      <tag>QTL-seq</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Nat. Genet | 一个优良抗旱玉米种质的基因组组装与遗传剖析</title>
    <link href="/2023/04/20/20230420-DroughtResistantMaizeGermplasm/"/>
    <url>/2023/04/20/20230420-DroughtResistantMaizeGermplasm/</url>
    
    <content type="html"><![CDATA[<p>玉米（<em>Zea mays</em>）是重要的粮食作物和饲料作物，同时也是重要的工业原料，并且在世界范围内广泛种植。干旱胁迫会导致作物严重减产，挖掘抗旱种质资源，选育高产抗旱品种可以缓解这一问题。作者在自然群体中筛选出一个具有抗旱特性的玉米种质资源（CIMBL55）。相较于B73和Mo17，CIMBL55具有较高的苗期存活率以及干旱条件下较低的产量损失。</p><p><img src="/2023/04/20/20230420-DroughtResistantMaizeGermplasm/phenotype.png" alt="CIMBL55具有显著抗旱性" title="CIMBL55具有显著抗旱性"></p><h2 id="基因组组装和共线性分析"><a href="#基因组组装和共线性分析" class="headerlink" title="基因组组装和共线性分析"></a>基因组组装和共线性分析</h2><p>作者结合PacBio三代长读长测序、BioNano光学图谱以及Hi-C测序技术对CIMBL55进行基因组测序组装。通过BUSCO分析以及9个CIMBL55 BAC克隆序列比对，作者验证了其基因组的质量可靠。通过CIMBL55与B73基因组间共线性分析，作者讲CIMBL55基因分成同源染色体共线性基因、非同源染色体重复基因、contigs上的共线性基因、不在共线性block中的直系同源基因和没有直系同源蛋白序列的基因5类。其中属于class 1-3的基因（Synteny）表达量显著高于class 4-5的基因（Noynteny）表达量。</p><p><img src="/2023/04/20/20230420-DroughtResistantMaizeGermplasm/genome_and_synteny.png" alt="基因组组装及共线性分析" title="基因组组装及共线性分析"></p><h2 id="SV鉴定"><a href="#SV鉴定" class="headerlink" title="SV鉴定"></a>SV鉴定</h2><p>作者将B73、Mo17和CIMBL55进行比对并鉴定了841,911个SV（&gt;20 bp），在玉米自然群体中鉴定了其中544,853个SVs的基因型。先前在自然群体中利用SNP鉴定的108个抗旱基因中有79个基因的优良等位基因（superior alleles）富集在CIMBL55中。进一步SV基因型进行关联分析，鉴定到69个基因包含和抗旱表型显著关联的SV，其中65个基因的优良单倍型（SNP和SV）富集在CIMBL55中。<em>ZmABF4</em>编码bZIP转录因子，可以调控ABA和干旱诱导的基因表达，在<em>ZmABF4</em>的第二个内含子上鉴定到一个SNP和一个SV，这两个变异和基因表达量、抗旱性显著关联。在自然群体中带有<em>ZmABF4<sup>CIMBL55</sup><em>单倍型的个体具有更高的</em>ZmABF4</em>表达量和抗旱性，而且<em>ZmABF4<sup>B73</sup><em>超表达植株和野生型相比表现出更高的抗旱性，表明</em>ZmABF4</em>可以正调控玉米抗旱性。</p><p><img src="/2023/04/20/20230420-DroughtResistantMaizeGermplasm/SV.PNG" alt="SV" title="SV"></p><h2 id="表观基因组变异影响玉米抗旱"><a href="#表观基因组变异影响玉米抗旱" class="headerlink" title="表观基因组变异影响玉米抗旱"></a>表观基因组变异影响玉米抗旱</h2><p>根据CIMBL55基因组插入片段（包括0.5-kb-flanking regions）的mCG、mCHG和mCHH甲基化水平使用层次聚类将其分为5类，其中第四类插入片段和flanking regions相比具有更高的甲基化水平，这类插入片段富集了大量DNA-TEs且距离转录起始位点较近。一些NAC-domain-containing transcription factor家族成员对失水胁迫抗性有积极作用。和<em>ZmNAC075<sup>CIMBL55</sup><em>相比</em>ZmNAC075<sup>B73</sup><em>上游有两个插入片段，这两个片段被超甲基化可能导致</em>ZmNAC075</em>表达量降低进而导致玉米抗旱性降低。</p><p><img src="/2023/04/20/20230420-DroughtResistantMaizeGermplasm/epigenomic_variations.png" alt="表观基因组变异影响玉米抗旱性" title="表观基因组变异影响玉米抗旱性"></p><h2 id="ZmRtn16提高玉米抗旱性"><a href="#ZmRtn16提高玉米抗旱性" class="headerlink" title="ZmRtn16提高玉米抗旱性"></a>ZmRtn16提高玉米抗旱性</h2><p>通过比较基因组分析鉴定到<em>ZmRtn16<sup>CIMBL55</sup><em>的3′-UTR区域存在一个28 bp缺失片段，带有这一缺失片段的玉米种质具有更高的抗旱性且</em>ZmRtn16</em>表达量更高，同时这一缺失片段可以增强<em>ZmRtn16</em>转录本的稳定性。<em>ZmRtn16</em>超表达株系、<em>crispr</em>敲除株系和野生型对照株系比较分析表明，<em>ZmRtn16</em>可以降低干旱条件下的玉米叶片气孔开度和降低失水率，从而减少干旱条件下的产量损失和增强抗旱性。进一步实验表明，<em>ZmRtn16</em>可以和ZmVHA-A以及ZmVHA-E3互作，促进ZmVHA-A和ZmVHA-E3定位到液泡膜上并增强V-H<sup>+</sup>-ATPase活性。</p><p><img src="/2023/04/20/20230420-DroughtResistantMaizeGermplasm/ZmRtn16.png" alt="ZmRtn16提高玉米抗旱性" title="ZmRtn16提高玉米抗旱性"></p><p><strong>原文链接</strong></p><p><a href="https://www.nature.com/articles/s41588-023-01297-y">Tian T, Wang S, Yang S, et al. Genome assembly and genetic dissection of a prominent drought-resistant maize germplasm. Nat Genet. 2023;55(3):496-506. doi:10.1038/s41588-023-01297-y</a></p>]]></content>
    
    
    <categories>
      
      <category>文献解读</category>
      
    </categories>
    
    
    <tags>
      
      <tag>基因组</tag>
      
      <tag>SV</tag>
      
      <tag>抗旱</tag>
      
      <tag>玉米</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>R绘图 | 群体表型分布和相关关系</title>
    <link href="/2023/03/22/20230322-pheCorDist/"/>
    <url>/2023/03/22/20230322-pheCorDist/</url>
    
    <content type="html"><![CDATA[<p>考察一个群体的多个表型或者一个表型的多个重复，我们想展示其分布和他们之间的相关关系可以使用柱状图和散点图（如下图所示）。<br><img src="/2023/03/22/20230322-pheCorDist/pheCorDist.png" alt="不同重复的表型分布和相关性" title="不同重复的表型分布和相关性"><br>这幅图主要有两部分组成，一个是对角线上的柱状图，使用柱状图展示了每一个表型重复的分布；另一个就是对角线下面的散点图，用散点图展示两两之间的相关关系，并且用不同颜色表示点的密度，在上面标注其相关性。下面我们将使用R语言完成这幅图。</p><p>对于这幅图我们可以先分别绘制其中每一个部分，然后使用图片组合、拼接函数进行整合：</p><h2 id="分图绘制"><a href="#分图绘制" class="headerlink" title="分图绘制"></a>分图绘制</h2><p>首先导入数据，数据格式如下，每一行代表一个样本，每一列代表一个重复：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-operator">&gt;</span>data <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;./data.txt&quot;</span><span class="hljs-punctuation">,</span> header <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">,</span> row.names <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> sep <span class="hljs-operator">=</span> <span class="hljs-string">&quot;\t&quot;</span><span class="hljs-punctuation">)</span><br><span class="hljs-operator">&gt;</span>data<br>     pheno16rep1 pheno16rep2 pheno17 pheno18rep1 pheno18rep2<br>s1          <span class="hljs-number">28.4</span>        <span class="hljs-number">24.9</span>  <span class="hljs-number">27.740</span>    <span class="hljs-number">27.72500</span>    <span class="hljs-number">29.30000</span><br>s2          <span class="hljs-number">26.6</span>        <span class="hljs-number">25.3</span>      <span class="hljs-literal">NA</span>          <span class="hljs-literal">NA</span>          <span class="hljs-literal">NA</span><br>s3          <span class="hljs-number">27.8</span>        <span class="hljs-number">27.0</span>  <span class="hljs-number">24.660</span>          <span class="hljs-literal">NA</span>    <span class="hljs-number">27.97500</span><br>s4          <span class="hljs-number">25.5</span>        <span class="hljs-number">26.9</span>  <span class="hljs-number">22.680</span>    <span class="hljs-number">29.27500</span>    <span class="hljs-number">25.95000</span><br>s5          <span class="hljs-number">26.5</span>        <span class="hljs-number">28.7</span>  <span class="hljs-number">24.760</span>    <span class="hljs-number">31.97500</span>    <span class="hljs-number">27.52000</span><br>s6          ....        ....  .......   ........    ........<br></code></pre></td></tr></table></figure><p>使用<code>ggplot2</code>扩展包绘制每一个分图。柱状图使用<code>geom_histogram()</code>绘制，散点图使用<code>ggpointdensity</code>包的<code>geom_pointdensity()</code>函数绘制，使用<code>cor()</code>函数计算两个重复之间的相关系数，并将其放在图片标题位置，并使用<code>ggtext</code>包的<code>element_markdown()</code>函数设置标题的主题，同时使用<code>cowplot</code>包的<code>theme_half_open()</code>函数设置整体主题。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-operator">&gt;</span>library<span class="hljs-punctuation">(</span>tidyverse<span class="hljs-punctuation">)</span><br><span class="hljs-operator">&gt;</span>library<span class="hljs-punctuation">(</span>ggpointdensity<span class="hljs-punctuation">)</span><br><span class="hljs-operator">&gt;</span>library<span class="hljs-punctuation">(</span>cowplot<span class="hljs-punctuation">)</span><br><span class="hljs-operator">&gt;</span>library<span class="hljs-punctuation">(</span>ggtext<span class="hljs-punctuation">)</span><br><span class="hljs-operator">&gt;</span><br><span class="hljs-operator">&gt;</span><span class="hljs-comment"># 柱状图</span><br><span class="hljs-operator">&gt;</span>p1 <span class="hljs-operator">&lt;-</span> ggplot<span class="hljs-punctuation">(</span>data<span class="hljs-punctuation">,</span> aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> pheno16rep1<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <br><span class="hljs-operator">&gt;</span>        geom_histogram<span class="hljs-punctuation">(</span>binwidth <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br><span class="hljs-operator">&gt;</span>        labs<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> <span class="hljs-literal">NULL</span><span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> <span class="hljs-literal">NULL</span><span class="hljs-punctuation">,</span> title <span class="hljs-operator">=</span> cn<span class="hljs-punctuation">[</span>i<span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br><span class="hljs-operator">&gt;</span>        theme_half_open<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br><span class="hljs-operator">&gt;</span>        theme<span class="hljs-punctuation">(</span>plot.title <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>hjust <span class="hljs-operator">=</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><span class="hljs-operator">&gt;</span><span class="hljs-comment"># 散点密度图</span><br><span class="hljs-operator">&gt;</span>p2 <span class="hljs-operator">&lt;-</span> ggplot<span class="hljs-punctuation">(</span>data<span class="hljs-punctuation">,</span> aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> pheno16rep2<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> pheno16rep1<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br><span class="hljs-operator">&gt;</span>        geom_pointdensity<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br><span class="hljs-operator">&gt;</span>        scale_color_continuous<span class="hljs-punctuation">(</span>type <span class="hljs-operator">=</span> <span class="hljs-string">&quot;viridis&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span>                <span class="hljs-comment"># 设置点密度颜色梯度</span><br><span class="hljs-operator">&gt;</span>        labs<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> <span class="hljs-literal">NULL</span><span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> <span class="hljs-literal">NULL</span><span class="hljs-punctuation">,</span> title <span class="hljs-operator">=</span> paste<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;*R*: &quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">round</span><span class="hljs-punctuation">(</span>cor<span class="hljs-punctuation">(</span>df<span class="hljs-operator">$</span>col1<span class="hljs-punctuation">,</span> df<span class="hljs-operator">$</span>col2<span class="hljs-punctuation">,</span> use <span class="hljs-operator">=</span> <span class="hljs-string">&quot;na.or.complete&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> sep <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br><span class="hljs-operator">&gt;</span>        theme_half_open<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br><span class="hljs-operator">&gt;</span>        theme<span class="hljs-punctuation">(</span>legend.position <span class="hljs-operator">=</span> <span class="hljs-string">&quot;NA&quot;</span><span class="hljs-punctuation">,</span> <br><span class="hljs-operator">&gt;</span>           plot.title <span class="hljs-operator">=</span> element_markdown<span class="hljs-punctuation">(</span>hjust <span class="hljs-operator">=</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span><br><span class="hljs-operator">&gt;</span>                           face <span class="hljs-operator">=</span> <span class="hljs-string">&quot;plain&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><p><img src="/2023/03/22/20230322-pheCorDist/single.png" alt="柱状图和散点图" title="柱状图和散点图"></p><h2 id="组合图片"><a href="#组合图片" class="headerlink" title="组合图片"></a>组合图片</h2><p>使用customLayout包进行图片组合，这个包可以对base绘图和ggplot2绘图进行整合，而且比较灵活。首先需要lay_new()函数创建一个拼接画布，然后使用lay_grid()函数组合各个图片。因为总共有5个重复，因此需要一个5×5的画图，如下图所示，各个分图从左上角开始往下排列走”之“字形排列。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-operator">&gt;</span>lay <span class="hljs-operator">&lt;-</span> lay_new<span class="hljs-punctuation">(</span>mat <span class="hljs-operator">=</span> matrix<span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">25</span><span class="hljs-punctuation">,</span> nrow <span class="hljs-operator">=</span> <span class="hljs-number">5</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> widths <span class="hljs-operator">=</span> <span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> heights <span class="hljs-operator">=</span> <span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><span class="hljs-operator">&gt;</span>lay_show<span class="hljs-punctuation">(</span>lay<span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><p><img src="/2023/03/22/20230322-pheCorDist/layout.png" alt="布局" title="布局"><br>现在出现了一个问题，我们并没有在对角线上方安排图片，而lay_new()产生的是一个矩形排列画布，因此我们需要在右上角填充空白图片，并将空白图和柱状图、散点密度图整合。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-operator">&gt;</span>p <span class="hljs-operator">&lt;-</span> ggplot<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> theme_nothing<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br><span class="hljs-operator">&gt;</span>lay_grid<span class="hljs-punctuation">(</span><span class="hljs-built_in">list</span><span class="hljs-punctuation">(</span>p1<span class="hljs-punctuation">,</span> p2<span class="hljs-punctuation">,</span> p3<span class="hljs-punctuation">,</span> ...<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> lay<span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><h2 id="整理以上过程"><a href="#整理以上过程" class="headerlink" title="整理以上过程"></a>整理以上过程</h2><p>在一个5×5的组合中我们总共需要绘制25个分图，其中有多次重复的过程，并且最终图片是矩形有规律分布，因此为了减少代码长度我们可以使用循环来处理每个分图。根据lay_new()的组合形式可以设置两层循环分别处理行和列，并且因为组合图是从左上角开始向下排布，因此外层循环用来处理行，内层分布处理列。最后一点就是可以把这一系列代码写成一个function，方便以后使用。</p><p>最终代码如下所示：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs R">library<span class="hljs-punctuation">(</span>tidyverse<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>ggpointdensity<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>cowplot<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>ggtext<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>customLayout<span class="hljs-punctuation">)</span><br><br><span class="hljs-comment">## 定义pheCorDist函数</span><br>pheCorDist <span class="hljs-operator">&lt;-</span> <span class="hljs-keyword">function</span><span class="hljs-punctuation">(</span>data<span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-comment">#</span><br>  n <span class="hljs-operator">&lt;-</span> ncol<span class="hljs-punctuation">(</span>data<span class="hljs-punctuation">)</span><br>  cn <span class="hljs-operator">&lt;-</span> colnames<span class="hljs-punctuation">(</span>data<span class="hljs-punctuation">)</span><br>  Pall <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">list</span><span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>  index <span class="hljs-operator">&lt;-</span> 1<br>  <span class="hljs-comment">#</span><br>  <span class="hljs-keyword">for</span> <span class="hljs-punctuation">(</span>j <span class="hljs-keyword">in</span> <span class="hljs-number">1</span><span class="hljs-operator">:</span>n<span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-keyword">for</span> <span class="hljs-punctuation">(</span>i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span><span class="hljs-operator">:</span>n<span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>      df <span class="hljs-operator">&lt;-</span> data<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span>i<span class="hljs-punctuation">,</span>j<span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><br>      colnames<span class="hljs-punctuation">(</span>df<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;col1&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;col2&quot;</span><span class="hljs-punctuation">)</span><br>      <span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span>i <span class="hljs-operator">==</span> j<span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>        p <span class="hljs-operator">&lt;-</span> ggplot<span class="hljs-punctuation">(</span>df<span class="hljs-punctuation">,</span> aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> col1<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <br>          geom_histogram<span class="hljs-punctuation">(</span>binwidth <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>          labs<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> <span class="hljs-literal">NULL</span><span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> <span class="hljs-literal">NULL</span><span class="hljs-punctuation">,</span> title <span class="hljs-operator">=</span> cn<span class="hljs-punctuation">[</span>i<span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>          theme_half_open<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>          theme<span class="hljs-punctuation">(</span>plot.title <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>hjust <span class="hljs-operator">=</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>      <span class="hljs-punctuation">&#125;</span> <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span>i <span class="hljs-operator">&gt;</span> j<span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>        p <span class="hljs-operator">&lt;-</span> ggplot<span class="hljs-punctuation">(</span>df<span class="hljs-punctuation">,</span> aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> col2<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> col1<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>          geom_pointdensity<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>          scale_color_continuous<span class="hljs-punctuation">(</span>type <span class="hljs-operator">=</span> <span class="hljs-string">&quot;viridis&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>          labs<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> <span class="hljs-literal">NULL</span><span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> <span class="hljs-literal">NULL</span><span class="hljs-punctuation">,</span> title <span class="hljs-operator">=</span> paste<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;*R*: &quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">round</span><span class="hljs-punctuation">(</span>cor<span class="hljs-punctuation">(</span>df<span class="hljs-operator">$</span>col1<span class="hljs-punctuation">,</span> df<span class="hljs-operator">$</span>col2<span class="hljs-punctuation">,</span> use <span class="hljs-operator">=</span> <span class="hljs-string">&quot;na.or.complete&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> sep <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>          theme_half_open<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>          theme<span class="hljs-punctuation">(</span>legend.position <span class="hljs-operator">=</span> <span class="hljs-string">&quot;NA&quot;</span><span class="hljs-punctuation">,</span> <br>                plot.title <span class="hljs-operator">=</span> element_markdown<span class="hljs-punctuation">(</span>hjust <span class="hljs-operator">=</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span><br>                                              face <span class="hljs-operator">=</span> <span class="hljs-string">&quot;plain&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>      <span class="hljs-punctuation">&#125;</span> <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span><span class="hljs-punctuation">(</span>i <span class="hljs-operator">&lt;</span> j<span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>        p <span class="hljs-operator">&lt;-</span> ggplot<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> theme_nothing<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>      <span class="hljs-punctuation">&#125;</span><br>      Pall<span class="hljs-punctuation">[</span>index<span class="hljs-punctuation">]</span><span class="hljs-punctuation">[[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> p<br>      index <span class="hljs-operator">=</span> index <span class="hljs-operator">+</span> <span class="hljs-number">1</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><br>  lay <span class="hljs-operator">&lt;-</span> lay_new<span class="hljs-punctuation">(</span>mat <span class="hljs-operator">=</span> matrix<span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-operator">:</span>n<span class="hljs-operator">^</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span> nrow <span class="hljs-operator">=</span> n<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> widths <span class="hljs-operator">=</span> <span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> n<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> heights <span class="hljs-operator">=</span> <span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> n<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>  lay_grid<span class="hljs-punctuation">(</span>Pall<span class="hljs-punctuation">,</span> lay<span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">&#125;</span><br><br><span class="hljs-comment"># 导入数据并绘图</span><br>data <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;./data.txt&quot;</span><span class="hljs-punctuation">,</span> header <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">,</span> row.names <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> sep <span class="hljs-operator">=</span> <span class="hljs-string">&quot;\t&quot;</span><span class="hljs-punctuation">)</span><br>png<span class="hljs-punctuation">(</span>filename <span class="hljs-operator">=</span> <span class="hljs-string">&quot;test.png&quot;</span><span class="hljs-punctuation">,</span> width <span class="hljs-operator">=</span> <span class="hljs-number">10</span><span class="hljs-punctuation">,</span> height <span class="hljs-operator">=</span> <span class="hljs-number">8</span><span class="hljs-punctuation">,</span> units <span class="hljs-operator">=</span> <span class="hljs-string">&quot;in&quot;</span><span class="hljs-punctuation">,</span> res <span class="hljs-operator">=</span> <span class="hljs-number">500</span><span class="hljs-punctuation">)</span><br>pheCorDist<span class="hljs-punctuation">(</span>data<span class="hljs-punctuation">)</span><br>dev.off<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>技术分享</category>
      
    </categories>
    
    
    <tags>
      
      <tag>R</tag>
      
      <tag>绘图</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Nat. Commun | 醋栗番茄基因组为研究番茄育种过程中的结构变异提供了依据</title>
    <link href="/2023/03/21/20230321-SolanumPimpinellifoliumGenome/"/>
    <url>/2023/03/21/20230321-SolanumPimpinellifoliumGenome/</url>
    
    <content type="html"><![CDATA[<p>醋栗番茄（<em>Solanum lycopersicum</em>, SP）是栽培番茄（<em>S. lycopersicum</em>）的野生祖先种，他的果实小、颜色红呈现圆形。醋栗番茄在南美洲被驯化形成了观赏番茄（<em>S. lycopersicum</em> var. <em>cerasiforme</em>, SLC），随后在中美洲被改良成现在可食用的大果型栽培番茄（<em>S. lycopersicum</em> var. <em>lycopersicum</em>, SLL）。醋栗番茄和栽培番茄之间可以自由杂交，因此醋栗番茄可以为栽培番茄的抗性、品质性状改良提供基因资源。高质量的醋栗番茄参考基因组将为两者之间基因组变异鉴定、重要的驯化相关基因挖掘以及栽培番茄育种改良提供帮助。</p><p><img src="/2023/03/21/20230321-SolanumPimpinellifoliumGenome/domestication.png" alt="从醋栗番茄到栽培番茄" title="从醋栗番茄到栽培番茄 (Lin et al. Nature Genetics, 2014)"></p><h2 id="一个高质量的醋栗番茄基因组以及野生番茄、栽培番茄之间广泛的结构变异"><a href="#一个高质量的醋栗番茄基因组以及野生番茄、栽培番茄之间广泛的结构变异" class="headerlink" title="一个高质量的醋栗番茄基因组以及野生番茄、栽培番茄之间广泛的结构变异"></a>一个高质量的醋栗番茄基因组以及野生番茄、栽培番茄之间广泛的结构变异</h2><p>作者结合PacBio长读长测序、Hi-C染色质互作信息、与栽培番茄基因组间共线性信息以及遗传连锁图组装了一个高质量的醋栗番茄LA2093的参考基因组，并通过与遗传图共线性分析、BUSCO分析等验证了组装结果的可靠性。基因组结构变异（structural variants, SVs）包括插入缺失、倒位、重复等，对作物驯化有重要的影响，因此作者通过基因组间比较鉴定了LA2093和现代栽培番茄Heinz 1706间的结构变异，并且发现<em>gypsy</em>-like的逆转录转座子区域有更高的indels发生频率，而只有14.8% indels发生在基因区或启动子区，但这些indels足以和一半以上的基因重叠，富集分析表明这些indels可能和野生番茄、栽培番茄之间的抗病性以及品质性状相关。</p><p><img src="/2023/03/21/20230321-SolanumPimpinellifoliumGenome/genome.png" alt="醋栗番茄基因组及结构变异" title="醋栗番茄基因组及结构变异"></p><h2 id="番茄驯化和育种过程中对SVs的选择以及对农艺性状的影响"><a href="#番茄驯化和育种过程中对SVs的选择以及对农艺性状的影响" class="headerlink" title="番茄驯化和育种过程中对SVs的选择以及对农艺性状的影响"></a>番茄驯化和育种过程中对SVs的选择以及对农艺性状的影响</h2><p>利用重测序信息，作者鉴定了597份野生和栽培番茄（51份SP, 6份S. cheesmaniae和S. galapagense (SCG), 228份SLC, 226份heirloom, 52份现代栽培种和34份其他栽培种）在这些SVs位点的基因型。通过比较不同群体种SV基因型频率发现，驯化和改良改变了SV基因型的分布，LA2093类型的纯合SV在野生番茄中广泛存在，而Heinz 1706类型的纯合SVs在栽培番茄中逐渐固定下来。这些收到驯化、改良选择的SVs影响到胁迫和刺激相应、生物合成、细胞分化、胚发育、授粉和生殖过程相关的基因。随后作者研究了影响果实大小、番茄红素含量和成熟相关基因SV的不同等位基因频率在不同群体中的动态变化以及不同基因型的表达量差异，证实了SV在番茄驯化改良过程中的重要作用。对这些SV的研究为将来育种改良番茄的品质、抗性的提供新的目标基因。</p><p><img src="/2023/03/21/20230321-SolanumPimpinellifoliumGenome/selection1.png" alt="驯化改良对SV基因型频率的影响" title="驯化改良对SV基因型频率的影响"></p><p><img src="/2023/03/21/20230321-SolanumPimpinellifoliumGenome/selection2.png" alt="果实大小基因的SV频率和表达量变化" title="果实大小基因的SV频率和表达量变化"></p><h2 id="全基因组eQTL鉴定"><a href="#全基因组eQTL鉴定" class="headerlink" title="全基因组eQTL鉴定"></a>全基因组eQTL鉴定</h2><p>利用已发表的番茄果实转录组数据，作者鉴定到10,789个eQTL影响了5595个基因的表达，其中cis-eQTL和trans-eQTL相比可以解释更多的表达量变异。作者进一步鉴定了48个eQTL热点区域，这些热点区域调控了554个基因的表达。</p><p><img src="/2023/03/21/20230321-SolanumPimpinellifoliumGenome/eQTL.png" alt="eQTL" title="eQTL"></p><hr><p><strong>原文链接</strong></p><p><a href="https://www.nature.com/articles/s41467-020-19682-0">Wang X, Gao L, Jiao C, et al. Genome of Solanum pimpinellifolium provides insights into structural variants during tomato breeding. Nat Commun. 2020;11(1):5817. Published 2020 Nov 16. doi:10.1038/s41467-020-19682-0</a></p>]]></content>
    
    
    <categories>
      
      <category>文献解读</category>
      
    </categories>
    
    
    <tags>
      
      <tag>基因组</tag>
      
      <tag>SV</tag>
      
      <tag>eQTL</tag>
      
      <tag>驯化</tag>
      
      <tag>番茄</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>我的第一篇博客</title>
    <link href="/2023/03/13/20230313-firstArticle/"/>
    <url>/2023/03/13/20230313-firstArticle/</url>
    
    <content type="html"><![CDATA[<h2 id="我搭建了一个博客网站"><a href="#我搭建了一个博客网站" class="headerlink" title="我搭建了一个博客网站"></a>我搭建了一个博客网站</h2><p>如题所说这是这个网站上的第一篇博客，以后会在这里分享一些学习、生活相关的文章。为什么会搭建一个网站来写博客呢？相较于简书、知乎、微信公众号等平台，个人网站有更高的灵活性，版面设计更加丰富；相比于微博、小红书等社交平台，个人网站内容更加纯粹，广告更少，字数等限制也更少；还有一点就是搭建个网站看起来很厉害。</p><h2 id="网站内容"><a href="#网站内容" class="headerlink" title="网站内容"></a>网站内容</h2><p>以后大概会分享以下几个方面的文章：</p><ul><li>日常生活</li><li>文献解读</li><li>编程技术</li><li>软件工具</li><li>… …</li></ul><h2 id="技术框架"><a href="#技术框架" class="headerlink" title="技术框架"></a>技术框架</h2><p>前面提到搭建网站看起来很厉害，其实真正操作起来并不难。就像做一个PPT可以用Microsoft PowerPoint，甚至还有很多好看的模板可以下载使用，做博客网站也有很多成熟的框架和主题可以使用。这个网站是使用<a href="https://hexo.io/zh-cn/index.html">Hexo</a>搭建，选用<a href="https://github.com/fluid-dev/hexo-theme-fluid">Fluid</a>主题，使用markdown语法来写文章。以上步骤完成后把网站部署在<a href="https://github.com/">GitHub</a>上就可以供大家访问了。最后在阿里云上购买了一个域名（可选），最终做成一个现在大家看到的网站了。以后可以写一篇博客详细讲一讲搭建这个网站的过程。</p><p><img src="/2023/03/13/20230313-firstArticle/LaowangAndHuining_20230313210505.png" alt="老王和惠宁" title="老王和女朋友在公园划船"></p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
